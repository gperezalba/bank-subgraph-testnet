type Identity @entity {
    id: ID! #PIBIdentity_address
    dataHash: Bytes!
    owner: Bytes!
    recovery: Bytes!
    state: Int!
    wallet: Wallet!
    lastModification: BigInt!
    creationTime: BigInt!
}

type Token @entity {
    id: ID! #token_address
    tokenDecimals: Int!
    tokenSymbol: String!
    tokenName: String!
    totalSupply: BigInt!
    holders: [TokenBalance!]
    updated: Boolean!
    isNFT: Boolean!
    nftCategory: BigInt
}

type Wallet @entity {
    id: ID! #wallet_address
    name: Name
    identity: Identity @derivedFrom(field: "wallet")
    isBankUser: Boolean
    balances: [TokenBalance!] @derivedFrom(field: "wallet")
    transactions: [Transaction!]
}

type Name @entity {
    id: ID! #name_string
    name: String
    wallet: Wallet!
    owner: Bytes
}

type TokenBalance @entity {
    id: ID! #token_address-wallet_address
    token: Token!
    wallet: Wallet!
    balance: BigInt!
    commodities: [Commodity!]
    updated: Boolean!
}

type BankTransaction @entity {
    id: ID! #event.transaction.hash.toHex() + "-" + event.logIndex.toString()
    transaction: Transaction!
    kind: BigInt
    concept: String
    bankFee: BankFee
    info: String #Market's change when is an exchange tx for example
}

type Transaction @entity {
    id: ID! #event.transaction.hash.toHex() + "-" + event.logIndex.toString()
    from: Wallet!
    to: Wallet!
    currency: Token!
    amount: BigInt!
    data: Bytes!
    fee: BigInt!
    timestamp: BigInt!
    isBankTransaction: Boolean
    bankTransaction: BankTransaction @derivedFrom(field: "transaction")
    nftCategory: BigInt
    nftDescription: Commodity
    officialCategory: BigInt
    officialDescription: Official
}

type BankFee @entity {
    id: ID! #event.transaction.hash.toHex()
    transaction: BankTransaction! @derivedFrom(field: "bankFee")
    fee: BigInt
    kind: BigInt 
    info: String
}

type Commodity @entity {
  id: ID!
  tokenId: BigInt!
  gold: Gold
  diamond: Diamond
}

type Gold @entity {
  id: ID!
  owner: Wallet!
  reference: String!
  token: Token!
  weight_brute: BigInt
  weight_fine: BigInt
  law: BigInt
  isLive: Boolean
  isFake: Boolean
  commodity: Commodity! @derivedFrom(field: "gold")
}

type Diamond @entity {
  id: ID!
  owner: Wallet!
  reference: String!
  token: Token!
  color: BigInt
  clarity: BigInt #cambiar a BigDecimal para filtrar?
  cut: BigInt
  carat_weight: BigInt
  isLive: Boolean
  isFake: Boolean
  commodity: Commodity! @derivedFrom(field: "diamond")
}

type Official @entity {
    id: ID!
    category: BigInt!
    description: String!
}